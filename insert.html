<!DOCTYPE html>
<html lang="pt-br">
<meta charset="UTF-8">
<title>Mowe Upload API - Insert</title>
<meta name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
<script src="dist/js/villa.min.js"></script>
<link rel="stylesheet" href="dist/css/villa.min.css"/>
<!--[if lt IE 9]>
<link rel="stylesheet" type="text/css" href="dist/css/material-colors.css"/>
<link rel="stylesheet" type="text/css" href="dist/css/villa-cross.min.css"/>
<script src="dist/js/html5shiv.js"></script>
<script src="dist/js/html5shiv-printshiv.js"></script>
<script src="dist/js/classList.min.js"></script>
<![endif]-->

<body>

<h3>Cadastro de informações</h3>

<input type="text" name="author" id="author" placeholder="Insira o nome"/><br>
<input type="text" name="age" id="age" placeholder="Insira a idade"/><br>
<p>Selecione:</p>
<input type="radio" name="gender" id="male" value="m" /> <label for="male">male</label><br>
<input type="radio" name="gender" id="female" value="f" /> <label for="female">female</label><br>
<input type="file" name="file" id="file" placeholder="Insira os arquivos" multiple="true"/><br><br>

<button id="btn">Call API!</button>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>

<script>

	var btn = document.getElementById('btn');

	btn.addEventListener('click', function (ev) {

		var authorValue = document.getElementById('author').value;
		var ageValue = document.getElementById('age').value;
		var genderValue = document.getElementsByName('gender').value;
		var filesValue = document.getElementById('file').files;

		// POST requisition through ajax (without jquery)
		var formData = new FormData();
		formData.append("author", authorValue);
		formData.append("age", ageValue);
		formData.append("gender", genderValue);
		for (var i = 0; i < filesValue.length; i++)
			formData.append("file[" + i + "]", filesValue[i]);
		// ^ maybe works without array

		var ajaxReq = new XMLHttpRequest();
		ajaxReq.open("POST", "http://localhost/upload-api/api/insert.php");
		ajaxReq.send(formData);
		ajaxReq.onload = function () {
			if (ajaxReq.status >= 200 && ajaxReq.status < 400) {
				try {
					var o = JSON.parse(ajaxReq.responseText);
					console.log(o);
				} catch (ex) {
					console.log("Error parse: " + ex);
				}
			} else {
				console.log("erro");
			}
		};
	});

</script>

</body>

</html>